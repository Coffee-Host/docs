---
title: æ•ˆèƒ½å„ªåŒ–
description: æå‡ä¼ºæœå™¨ TPSï¼Œæ¸›å°‘å»¶é²ï¼Œæ‰“é€ æµæš¢çš„éŠæˆ²é«”é©—
---

import { Callout } from "fumadocs-ui/components/callout";
import { Step, Steps } from "fumadocs-ui/components/steps";

<Callout title="ç‚ºä»€éº¼éœ€è¦æ•ˆèƒ½å„ªåŒ–ï¼Ÿ">
ç•¶ä¼ºæœå™¨çš„ TPSï¼ˆTicks Per Secondï¼‰ä½æ–¼ 20 æ™‚ï¼Œç©å®¶æœƒæ„Ÿå—åˆ°æ˜é¡¯çš„å»¶é²ã€‚é€éæ­£ç¢ºçš„è¨­å®šï¼Œå¯ä»¥åœ¨ä¸çŠ§ç‰²å¤ªå¤šéŠæˆ²é«”é©—çš„æƒ…æ³ä¸‹å¤§å¹…æå‡æ•ˆèƒ½ï¼
</Callout>

# äº†è§£ä¼ºæœå™¨æ•ˆèƒ½

## TPS æ˜¯ä»€éº¼ï¼Ÿ

TPSï¼ˆTicks Per Secondï¼‰ä»£è¡¨ä¼ºæœå™¨æ¯ç§’è™•ç†çš„éŠæˆ²åˆ»æ•¸ï¼š

| TPS | ç‹€æ…‹ | ç©å®¶æ„Ÿå— |
|-----|------|----------|
| 20 | âœ… å®Œç¾ | æµæš¢ç„¡å»¶é² |
| 18-19 | âš ï¸ è¼•å¾®æ‰å¹€ | å¹¾ä¹ç„¡æ„Ÿ |
| 15-17 | âš ï¸ ä¸­ç­‰å»¶é² | è¼•å¾®å¡é “ |
| 10-14 | âŒ åš´é‡å»¶é² | æ˜é¡¯å»¶é² |
| <10 | âŒ æ¥µåº¦å»¶é² | å¹¾ä¹ç„¡æ³•éŠç© |

## æŸ¥çœ‹ TPS

```
/tps          ï¼ˆPaper/Spigotï¼‰
/spark tps    ï¼ˆä½¿ç”¨ Spark æ’ä»¶ï¼‰
```

## å¸¸è¦‹æ•ˆèƒ½å•é¡Œä¾†æº

```
æ•ˆèƒ½æ¶ˆè€—æ’åï¼ˆé€šå¸¸æƒ…æ³ï¼‰ï¼š

1. ğŸ·ï¸ å¯¦é«”ï¼ˆEntityï¼‰     â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  40%
   - æ€ªç‰©ã€å‹•ç‰©ã€æ‰è½ç‰©ã€èˆ¹ã€ç¤¦è»Šç­‰

2. ğŸ§© ç´…çŸ³/æ¼æ–—         â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ        28%
   - ç´…çŸ³æ©Ÿå™¨ã€å¤§é‡æ¼æ–—

3. ğŸŒ å€å¡Šè¼‰å…¥          â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ          24%
   - ç©å®¶ç§»å‹•æ™‚è¼‰å…¥æ–°å€å¡Š

4. ğŸ”Œ æ’ä»¶              â–ˆâ–ˆâ–ˆâ–ˆ                   8%
   - æ•ˆèƒ½å·®çš„æ’ä»¶
```

# ä½¿ç”¨ Spark åˆ†æ

Spark æ˜¯æœ€å¥½ç”¨çš„æ•ˆèƒ½åˆ†ææ’ä»¶ï¼Œå¯ä»¥æ‰¾å‡ºå°è‡´å»¶é²çš„åŸå› ã€‚

<Steps>
    <Step>

    ### å®‰è£ Spark

    ä¸‹è¼‰ [Spark](https://spark.lucko.me/download) ä¸¦æ”¾å…¥ plugins è³‡æ–™å¤¾ã€‚

    </Step>

    <Step>

    ### é–‹å§‹åˆ†æ

    ç•¶ä¼ºæœå™¨å¡é “æ™‚ï¼ŒåŸ·è¡Œï¼š
    ```
    /spark profiler start
    ```

    ç­‰å¾… 1-2 åˆ†é˜å¾Œï¼š
    ```
    /spark profiler stop
    ```

    </Step>

    <Step>

    ### æŸ¥çœ‹å ±å‘Š

    Spark æœƒç”Ÿæˆä¸€å€‹ç¶²å€ï¼Œé–‹å•Ÿå¾Œå¯ä»¥çœ‹åˆ°ï¼š
    - ä»€éº¼æ±è¥¿ä½”ç”¨æœ€å¤š CPU
    - å“ªäº›æ’ä»¶æ•ˆèƒ½æœ€å·®
    - å¯¦é«”æ•¸é‡çµ±è¨ˆ

    ![Spark å ±å‘Š](/images/practice/performance/spark-report.png)

    </Step>

</Steps>

# Paper æ•ˆèƒ½è¨­å®š

Paper æä¾›è¨±å¤šæ•ˆèƒ½å„ªåŒ–é¸é …ï¼Œä½æ–¼ `config/paper-world-defaults.yml`ã€‚

## å¯¦é«”å„ªåŒ–

```yaml
entities:
  spawning:
    # æ¸›å°‘æ€ªç‰©ç”Ÿæˆæ•¸é‡ï¼ˆé è¨­ç‚º 70ï¼‰
    monster-spawn-limit: 50
    
    # æ¸›å°‘å‹•ç‰©ç”Ÿæˆæ•¸é‡ï¼ˆé è¨­ç‚º 10ï¼‰
    creature-spawn-limit: 8
    
    # æ¸›å°‘æ°´ç”Ÿç”Ÿç‰©
    water-animal-spawn-limit: 3
    water-ambient-spawn-limit: 10
    
    # æ¸›å°‘ç’°å¢ƒç”Ÿç‰©ï¼ˆè™è ç­‰ï¼‰
    ambient-spawn-limit: 1

  behavior:
    # åœç”¨ä¸å¿…è¦çš„ AIï¼ˆå¯èƒ½å½±éŸ¿éŠæˆ²é«”é©—ï¼‰
    disable-chest-cat-detection: true
    
    # æ‘æ°‘å„ªåŒ–
    tick-inactive-villagers: false

  tracking-range-y:
    enabled: true
```

## å€å¡Šå„ªåŒ–

```yaml
chunks:
  # æ¸›å°‘å¯¦é«”å•Ÿç”¨ç¯„åœï¼ˆé è¨­ 32ï¼‰
  entity-per-chunk-save-limit:
    experience_orb: 16
    arrow: 8
    ender_pearl: 8
    
  # è‡ªå‹•å„²å­˜é–“éš”ï¼ˆtickï¼‰
  auto-save-interval: 6000
```

## æ¼æ–—å„ªåŒ–

```yaml
hopper:
  # ç¦ç”¨æ¼æ–—ç§»å‹•äº‹ä»¶ï¼ˆå¤§å¹…æå‡æ•ˆèƒ½ï¼‰
  disable-move-event: true
  
  # æ¼æ–—æª¢æ¸¬é–“éš”ï¼ˆtickï¼‰
  cooldown-when-full: true
```

<Callout type="warn" title="æ³¨æ„">
`disable-move-event: true` å¯èƒ½æœƒå°è‡´éƒ¨åˆ†ä¿è­·æ’ä»¶çš„æ¼æ–—ä¿è­·å¤±æ•ˆã€‚
</Callout>

# Spigot æ•ˆèƒ½è¨­å®š

ç·¨è¼¯ `spigot.yml`ï¼š

```yaml
world-settings:
  default:
    # æ€ªç‰©åˆä½µç¯„åœï¼ˆåˆä½µå¾Œåªè¨ˆç®—ä¸€å€‹å¯¦é«”ï¼‰
    merge-radius:
      exp: 6.0      # ç¶“é©—çƒ
      item: 4.0     # æ‰è½ç‰©
    
    # æ€ªç‰©ç”Ÿæˆç¯„åœï¼ˆè¼ƒä½ = è¼ƒå°‘æ€ªç‰©ï¼‰
    mob-spawn-range: 6
    
    # å¯¦é«”å•Ÿç”¨ç¯„åœï¼ˆæ–¹å¡Šï¼‰
    entity-activation-range:
      animals: 16      # å‹•ç‰©
      monsters: 24     # æ€ªç‰©
      raiders: 48      # æ å¥ªè€…
      misc: 8          # å…¶ä»–
      water: 8         # æ°´ç”Ÿ
      villagers: 16    # æ‘æ°‘
      flying-monsters: 32  # é£›è¡Œæ€ªç‰©
    
    # æ‘æ°‘å·¥ä½œç«™æª¢æ¸¬é–“éš”
    entity-tracking-range:
      players: 48
      animals: 48
      monsters: 48
      misc: 32
      other: 64
    
    # æ¯ tick æœ€å¤§ç”Ÿæˆæ•¸é‡
    ticks-per:
      animal-spawns: 400
      monster-spawns: 1
      autosave: 6000
```

# Bukkit æ•ˆèƒ½è¨­å®š

ç·¨è¼¯ `bukkit.yml`ï¼š

```yaml
spawn-limits:
  monsters: 50      # é è¨­ 70
  animals: 8        # é è¨­ 10
  water-animals: 3  # é è¨­ 5
  water-ambient: 10 # é è¨­ 20
  ambient: 1        # é è¨­ 15

chunk-gc:
  period-in-ticks: 600

ticks-per:
  animal-spawns: 400
  monster-spawns: 1
  autosave: 6000
```

# å¯¦é«”æ¸…ç†

ä½¿ç”¨æ’ä»¶å®šæœŸæ¸…ç†å¯¦é«”å¯ä»¥æœ‰æ•ˆé™ä½è² è¼‰ã€‚

## ClearLagg

[ClearLagg](https://www.spigotmc.org/resources/clearlagg.68271/) å¯ä»¥å®šæœŸæ¸…ç†æ‰è½ç‰©å’Œå¯¦é«”ã€‚

```yaml
# plugins/ClearLagg/config.yml
auto-removal:
  enabled: true
  interval: 300    # æ¯ 300 ç§’ï¼ˆ5 åˆ†é˜ï¼‰æ¸…ç†ä¸€æ¬¡
  
  broadcast:
    enabled: true
    message: "&c[ç³»çµ±] å°‡åœ¨ 60 ç§’å¾Œæ¸…ç†æ‰è½ç‰©..."
    
  remove:
    items: true      # æ¸…ç†æ‰è½ç‰©
    primed-tnt: true # æ¸…ç† TNT
    falling-blocks: false
```

## CMI æ¸…ç†åŠŸèƒ½

å¦‚æœä½¿ç”¨ CMIï¼Œå¯ä»¥ä½¿ç”¨å…§å»ºçš„æ¸…ç†åŠŸèƒ½ï¼š

```
/cmi clear
```

æˆ–è¨­å®šè‡ªå‹•æ¸…ç†æ’ç¨‹ã€‚

# è¦–è·å„ªåŒ–

è¦–è·ï¼ˆView Distanceï¼‰å°æ•ˆèƒ½å½±éŸ¿å¾ˆå¤§ã€‚

```yaml
# server.properties
view-distance=8        # é è¨­ 10ï¼Œå»ºè­° 6-8

# spigot.ymlï¼ˆå¯ä»¥åˆ†ä¸–ç•Œè¨­å®šï¼‰
world-settings:
  default:
    view-distance: 8
  world_nether:
    view-distance: 6
  world_the_end:
    view-distance: 6
```

## æ¨¡æ“¬è·é›¢

æ¨¡æ“¬è·é›¢æ§åˆ¶å€å¡Šå…§å¯¦é«”çš„é‹ç®—ç¯„åœï¼š

```yaml
# server.properties
simulation-distance=6   # é è¨­ 10ï¼Œå»ºè­° 4-6
```

# é ç”Ÿæˆä¸–ç•Œ

æ–°å€å¡Šçš„ç”Ÿæˆéå¸¸æ¶ˆè€—æ•ˆèƒ½ã€‚é å…ˆç”Ÿæˆä¸–ç•Œå¯ä»¥é¿å…é€™å€‹å•é¡Œã€‚

## ä½¿ç”¨ Chunky

[Chunky](https://www.spigotmc.org/resources/chunky.81534/) å¯ä»¥é ç”Ÿæˆå€å¡Šã€‚

```
# é ç”ŸæˆåŠå¾‘ 5000 æ–¹å¡Š
/chunky radius 5000

# é–‹å§‹ç”Ÿæˆ
/chunky start

# æš«åœç”Ÿæˆ
/chunky pause
```

<Callout type="info">
é ç”Ÿæˆéç¨‹ä¸­ä¼ºæœå™¨å¯èƒ½æœƒå¡é “ï¼Œå»ºè­°åœ¨æ²’æœ‰ç©å®¶æ™‚é€²è¡Œã€‚
</Callout>

# æ•ˆèƒ½å„ªåŒ–æª¢æŸ¥æ¸…å–®

| é …ç›® | ç‹€æ…‹ | å½±éŸ¿ç¨‹åº¦ |
|------|------|----------|
| â˜ å®‰è£ Spark åˆ†æ | | â­â­â­â­â­ |
| â˜ èª¿æ•´ç”Ÿæ€ªæ•¸é‡é™åˆ¶ | | â­â­â­â­â­ |
| â˜ è¨­å®šå¯¦é«”å•Ÿç”¨ç¯„åœ | | â­â­â­â­ |
| â˜ å„ªåŒ–æ¼æ–—è¨­å®š | | â­â­â­â­ |
| â˜ èª¿æ•´è¦–è· | | â­â­â­â­ |
| â˜ è¨­å®šæ‰è½ç‰©åˆä½µ | | â­â­â­ |
| â˜ é ç”Ÿæˆä¸–ç•Œ | | â­â­â­ |
| â˜ å®šæœŸæ¸…ç†å¯¦é«” | | â­â­â­ |

<Callout type="warn" title="å¹³è¡¡æ•ˆèƒ½èˆ‡é«”é©—">
æ•ˆèƒ½å„ªåŒ–å¯èƒ½æœƒå½±éŸ¿éŠæˆ²é«”é©—ï¼ˆä¾‹å¦‚æ€ªç‰©è®Šå°‘ã€è¦–è·è®ŠçŸ­ï¼‰ã€‚è«‹æ ¹æ“šå¯¦éš›æƒ…æ³æ‰¾åˆ°é©åˆæ‚¨ä¼ºæœå™¨çš„å¹³è¡¡é»ã€‚
</Callout>
